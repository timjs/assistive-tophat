% !TEX root=../main.tex

\section{Assistive TopHat}
\label{sec:assistive}

Our goal is to provide next step hints, that lead users closer to their goal.
Goals are formulated in therms of the result value of a task.

A task $t$ is considered done, as soon as it has an observable value $v$.
To observe this value, the function $\Value$ as defined in section~\ref{sec:tophat} is used.

After obtaining the set of all symbolic executions, we need to filter out executions that do not fulfil the goal condition, or those where the goal is in conflict with the path condition.

Then, we take the first input so that we can return this to the user as a hint.

\begin{figure*}[t]
  \begin{function}
    \signature{firsts : \mathrm{Tasks} \times \mathrm{States} \times \mathrm{Goal}
      \rightarrow \powerset{\mathrm{Inputs} \times \mathrm{Predicates}}} \\
    firsts\ (t, \sigma, g) &=& map\ (\lambda (v,(i:is),\phi\land g\ v) \rightarrow (i,\phi)) (filter\ (\lambda(v,\_,\_)\rightarrow \Sat(\phi\land g\ v))\ (\Simulate\ (t,\sigma,[],\True)))

  \end{function}
  \caption{Firsts function definition.}
  \label{fig:firsts}
\end{figure*}

We also define an evaluation function that takes a task, state and list of inputs,
and returns the value of the task after application of all inputs.
This is a partial function since not all tasks have an observable value.

\begin{figure*}[t]
  \begin{function}
    \signature{evaluate : \mathrm{Tasks} \times \mathrm{States} \times [\mathrm{Inputs}]
      \rightarrow \mathrm{Values}} \\
    evaluate\ (t,\sigma,[])       &=& \Value(t,\sigma)\\
    evaluate\ (t, \sigma, (i:is)) &=& evaluate\ (t',\sigma',is) where\ t,\sigma\xrightarrow[]{i}t',\sigma'
  \end{function}
  \caption{evaluate function definition.}
  \label{fig:firsts}
\end{figure*}
